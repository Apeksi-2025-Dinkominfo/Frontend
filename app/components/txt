'use client';

import './globals.css';
import NavLogo from './components/navbarLogo';
import Footerr from './components/footer';
import { Box, Typography, useMediaQuery, useTheme } from '@mui/material';
import AdminSidebar from './components/sidebar';
import { usePathname } from 'next/navigation';
import React, { useState } from 'react';

export default function RootLayout({ children }) {
  const pathname = usePathname();
  const isAdminPage = pathname?.startsWith('/admin');

  const [isSidebarOpen, setIsSidebarOpen] = useState(true); // State untuk kontrol sidebar
  const handleToggleSidebar = () => setIsSidebarOpen(!isSidebarOpen);

  const sidebarWidth = 250; // Atur lebar sidebar saat terbuka
  const theme = useTheme();
  const isMobile = useMediaQuery(theme.breakpoints.down('sm'));

  return (
    <html lang="en">
      <body style={{ margin: 0, padding: 0, width: '100%', overflowX: 'hidden' }}>
        {/* Navbar */}
        {!isAdminPage && (
          <Box
            sx={{
              position: 'sticky',
              top: 0,
              zIndex: 1000,
              backgroundColor: 'white',
            }}
          >
            <NavLogo />
          </Box>
        )}

        {/* Konten utama dan footer */}
        <Box sx={{ display: 'flex', minHeight: '100vh' }}>
          {/* Sidebar */}
          {isAdminPage && !isMobile && (
            <AdminSidebar
              isSidebarOpen={isSidebarOpen}
              onToggleSidebar={handleToggleSidebar}
              activeButton={1}
              onButtonClick={() => {}}
            />
          )}

          {/* Konten */}
          <Box
            sx={{
              flexGrow: 1,
              marginLeft: isAdminPage && !isMobile ? (isSidebarOpen ? `${sidebarWidth}px` : '0') : '0',
              transition: 'margin-left 0.3s ease', // Transisi untuk animasi
              minHeight: 'calc(100vh - 80px)',
            }}
          >
            {children}
          </Box>
        </Box>

        {/* Footer */}
        {isAdminPage && (
          <Box
            sx={{
              marginLeft: isAdminPage && !isMobile ? (isSidebarOpen ? `${sidebarWidth}px` : '0') : '0',
              transition: 'margin-left 0.3s ease', // Transisi untuk animasi
              width: '100%',
            }}
          >
            <Footerr />
          </Box>
        )}
      </body>
    </html>
  );
}